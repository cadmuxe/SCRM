{% extends "base.html" %}

{% block title %}Index{% endblock %}


<!-- Css -->
{% block css %}
<link href="/static/css/timePicker.css" rel="stylesheet" type="text/css">
<style>
</style>
{% endblock %}

<!-- ++++++++++++Content+++++++++++++ -->
{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="span2">
            <!--Sidebar content-->
            <div class="" style="padding: 8px 0; margin-right:20px;">
            <ul class="nav nav-list">
                <li class="nav-header">
                    客户管理
                </li>
                <li>
                    <a href="/customer"><i class="icon-list"></i>列表</a>
                </li>

                <li class="active">
                    <a href="#"><ul><li>{{customer["name"]}}</li></ul></a>
                </li>
                <li>
                    <a href="/customer_add"><i class="icon-edit"></i>增加客户</a>
                </li>
            </ul>
            </div>
            
            
        </div>
        <div class="span10">
            <!--Body content-->
            <div class="row-fluid">
                <div id="basic_info" class="span10">
                    <table class="table table-striped table-bordered table-condensed">
                        <tbody>
                        <tr>
                            <td><strong>客户类型</strong></td>
                            <td colspan="5">{{customer['type']}}</td>
                        </tr>
                        <tr>
                            <td><strong>客户姓名</strong></td>
                            <td>{{customer['name']}}({{customer['gender']}})</td>
                            <td><strong>生日</strong></td>
                            <td colspan="3">{{customer['birthday']}}</td>
                        </tr>
                        <tr>
                            <td><strong>公司</strong></td><td colspan="3">{{customer['company']}}</td>
                        </tr>
                        <tr>
                            <td><strong>行业</strong></td><td>{{customer['sector']}}</td>
                            <td><strong>职业</strong></td><td>{{customer['vocation']}}</td>
                        </tr>
                        <tr>
                            <td><strong>电话</strong></td>
                            <td colspan="3">
                                {{customer['phone']['work']}}<em>工作</em>
                                {{customer['phone']['personal']}}<em>私人</em>
                                {{customer['phone']['home']}}<em>家庭</em>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>E-mail</strong></td>
                            <td colspan="3">
                                {{customer['email']['work']}}<em>工作</em>
                                {{customer['email']['personal']}}<em>私人</em>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>家庭住址</strong></td><td colspan="3">{{customer['home_addr']}}</td>
                        </tr>
                        <tr>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="span2">
                    <div>
                        <p>
                            <a class="btn btn-success" data-toggle="modal" href="#Modal_cal">
                                <i class="icon-calendar icon-white"></i> 记录活动
                            </a>
                        </p>
                        <p>
                            <a class="btn btn-primary" data-toggle="modal" href="#Modal_contract">
                                <i class="icon-file icon-white"></i> 记录合同
                            </a>
                        </p>
                    </div>

                </div>
            </div>

            <div class="row-fluid">
                <div id="relevance_info" class="span5">
                    <div class="page-header">
                        <h4>重要关系</h4>
                    </div>
                </div>
                <div id="social_info" class="span5">
                    <div class="page-header">
                        <h4>社会关系</h4>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div id="activity_info" class="span5">
                    <div class="page-header">
                        <h4>客户活动</h4>
                    </div>
                </div>
                <div id="welfare_info" class="span5">
                    <div class="page-header">
                        <h4>客户福利</h4>
                    </div>
                </div>
            </div>
            <div class="row" id="contract_info">
                <div class="page-header">
                    <h3>签约信息</h3>
                </div>
                <table class="table table-condensed">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>签约时间</th>
                        <th>项目</th>
                        <th>期限</th>
                        <th>金额</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for contract in contracts%}
                    <tr>
                        <td>{{contract.length}}</td>
                        <td>{{contact["date"]}}</td>
                        <td>{{contact["contract_project"]}}</td>
                        <td>{{contact["contract_start"]}}至{{contact["contract_end"]}}</td>
                        <td>{{contact["amount"]}}</td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>

            </div>

            <div class="row" id="contact_info">
                <div class="page-header">
                        <h3>联络记录</h3>
                    </div>
                <table class="table table-condensed">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th>时间</th>
                            <th>类型</th>
                            <th>内容</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for contact in contacts%}
                            <tr>
                                <td>{{contact.length}}</td>
                                <td>{{contact["start_date"]}} {{contact["start_time"]}}</td>
                                <td>{{contact["type"]}}</td>
                                <td>{{contact["remark"]}}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
            </div>


        </div>
    </div>
</div>

<div class="modal hide fade" id="Modal_cal">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>记录活动</h3>
    </div>
    <div class="modal-body">
    {% import 'forms.html' as forms with context%}
        {{forms.cal( customer)}}

    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Close</a>
        <a href="#" class="btn btn-primary" id="btn_add_cal">添加</a>
    </div>
</div>


<div class="modal hide fade" id="Modal_contract">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>记录合同</h3>
    </div>
    <div class="modal-body">
        {% import 'forms.html' as forms with context%}
        {{forms.contract( customer)}}

    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Close</a>
        <a href="#" class="btn btn-primary" id="btn_add_contract">添加</a>
    </div>
</div>

{% endblock %}







{% block js %}
<script>
    $(function() {
        $('#Modal_cal').modal('hide');
    });

    $('#btn_add_cal').click(function(){
        var cal = get_cal();
        var request = $.ajax({
            type: "POST",
            url: "/api/cal/save",
            contentType:"application/json",
            data: JSON.stringify(cal),
            success: function(data) {
            }
        });
        $('#Modal_cal').modal('hide');
        return false;
    });
 </script>
{% endblock %}
